(function(ekho) {
    var _scripTagId = '{{SCRIPT_ID}}',
        _url = '{{URL}}',
        _divId = '{{DIV_ID}}',
        _rendered = '{{{RENDERED}}}',
        styleTag = document.createElement('link');

    localstorage.set('ekho::ui', '{{ENABLE_UI}}');

    styleTag.rel   = 'stylesheet';
    styleTag.type  = 'text/css';
    styleTag.href  = _url + 'static/style.css';
    styleTag.media = 'all';
    document.getElementsByTagName('head')[0].appendChild(styleTag);

    styleTag       = document.createElement('link');
    styleTag.rel   = 'stylesheet';
    styleTag.type  = 'text/css';
    styleTag.href  = _url + 'static/cleanslate.css';
    styleTag.media = 'all';
    document.getElementsByTagName('head')[0].appendChild(styleTag);

    var div       = document.createElement('div');
    div.id        = _divId;
    div.innerHTML = _rendered;
    div.className = 'ekho-container cleanslate';

    var jqueryTag = document.createElement('script');
    jqueryTag.src = 
        'http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js';

    var fuzzySetTag = document.createElement('script');
    fuzzySetTag.src = 
        'https://raw.githubusercontent.com/Glench/fuzzyset.js/master/lib/fuzzyset.js';

    var ekhoJS = document.createElement('script');
    ekhoJS.src = _url + '/embed/';

    scriptTag = document.getElementById(_scripTagId);

    scriptTag.parentNode.insertBefore(jqueryTag, scriptTag.nextSibling);
    scriptTag.parentNode.insertBefore(fuzzySetTag, jqueryTag.nextSibling);
    scriptTag.parentNode.insertBefore(ekhoJS, fuzzySetTag.nextSibling);
})(this);
